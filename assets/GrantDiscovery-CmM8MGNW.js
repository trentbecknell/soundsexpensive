import{r as v,j as e}from"./vendor-react-CVTF6jdb.js";import{G as M,g as A}from"./main-FfQotaz1.js";import"./vendor-clerk-Amc1Y_id.js";import"./vendor-BUZ_dEBs.js";import"./flags-Y1Kcqn3e.js";import"./vendor-recharts-C88CGpXe.js";class S{static analyzeArtistProfile(t,a,c){const i=[];for(const r of c){const l=this.calculateCompatibilityScore(r,t,a),o=this.identifyMatchingFactors(r,t,a),m=this.generateRecommendations(r,t,a),x=this.identifyPotentialIssues(r,t,a);i.push({grant:r,compatibility_score:l,matching_factors:o,recommendations:m,potential_issues:x})}return i.sort((r,l)=>l.compatibility_score-r.compatibility_score)}static filterByEligibility(t,a,c){return t.filter(i=>{var r,l,o;if(i.eligibility.career_stage&&i.eligibility.career_stage.length>0){const m=(r=a.stage)==null?void 0:r.toLowerCase();if(!i.eligibility.career_stage.includes(m)&&!i.eligibility.career_stage.includes("any"))return!1}if(i.eligibility.genres&&i.eligibility.genres.length>0&&!(((l=c.identity)==null?void 0:l.primary_genres)||[]).some(u=>i.eligibility.genres.some(h=>u.toLowerCase().includes(h.toLowerCase())||h.toLowerCase().includes(u.toLowerCase()))))return!1;if(i.eligibility.geographic_restrictions&&i.eligibility.geographic_restrictions.length>0){const m=((o=a.city)==null?void 0:o.toLowerCase())||"";if(!i.eligibility.geographic_restrictions.some(u=>m.includes(u.toLowerCase())||u.toLowerCase()==="united states"||u.toLowerCase()==="usa"||u.toLowerCase()==="north america"))return!1}return!0})}static calculateCompatibilityScore(t,a,c){var u;let i=0,r=0;if(r+=20,t.eligibility.genres&&((u=c.identity)!=null&&u.primary_genres)){const h=this.calculateGenreOverlap(t.eligibility.genres,c.identity.primary_genres);i+=h*20}if(r+=15,t.eligibility.career_stage){const h=this.calculateStageMatch(t.eligibility.career_stage,a.stage);i+=h*15}if(r+=15,t.eligibility.project_type){const h=this.calculateProjectTypeMatch(t,a);i+=h*15}r+=10;const l=this.calculateAmountAppropriateScore(t,a,c);i+=l*10,r+=15;const o=this.calculateApplicationFeasibility(t,a,c);i+=o*15,r+=10;const m=this.calculateTimelineCompatibility(t);i+=m*10,r+=15;const x=this.calculateSuccessProbability(t,a,c);return i+=x*15,Math.round(i/r*100)}static identifyMatchingFactors(t,a,c){var m,x,u,h;const i=[];if(t.eligibility.genres&&((m=c.identity)!=null&&m.primary_genres)){const w=c.identity.primary_genres.filter(N=>t.eligibility.genres.some(y=>N.toLowerCase().includes(y.toLowerCase())));w.length>0&&i.push(`Accepts ${w.join(", ")} artists`)}(u=t.eligibility.career_stage)!=null&&u.includes((x=a.stage)==null?void 0:x.toLowerCase())&&i.push(`Targets ${a.stage} artists`),t.award_amount.min<=1e4&&a.stage==="Emerging"?i.push("Appropriate funding level for emerging artists"):t.award_amount.max>=25e3&&["Established","Breakout"].includes(a.stage)&&i.push("Substantial funding available for established artists"),t.category==="recording"&&((h=a.project)!=null&&h.projectType)&&i.push("Supports recording projects");const r=new Date(t.timeline.application_deadline),l=new Date;return Math.ceil((r.getTime()-l.getTime())/(1e3*60*60*24))>30&&i.push("Ample time to prepare application"),t.success_rate&&t.success_rate>.2&&i.push(`Good success rate (${Math.round(t.success_rate*100)}%)`),i}static generateRecommendations(t,a,c){const i=[];a.stage==="Emerging"?(i.push("Focus on your artistic development and potential in your application"),i.push("Highlight any mentorship or educational components of your project")):["Established","Breakout"].includes(a.stage)&&(i.push("Emphasize your track record and community impact"),i.push("Include detailed project outcomes and measurable goals")),t.requirements.work_samples&&i.push(`Prepare ${t.requirements.work_samples.quantity} high-quality work samples`),t.requirements.budget_required&&i.push("Create a detailed, realistic budget with line-item costs"),t.requirements.references_required&&i.push(`Secure ${t.requirements.references_required} strong professional references`),t.category==="recording"?i.push("Detail your recording plan, studio choices, and production team"):t.category==="touring"&&i.push("Include confirmed venues, routing plans, and audience development strategy");const r=new Date(t.timeline.application_deadline),l=new Date,o=Math.ceil((r.getTime()-l.getTime())/(1e3*60*60*24));return o<30?i.push("Priority application - deadline approaching soon"):o>90&&i.push("Start gathering materials early for this competitive opportunity"),i}static identifyPotentialIssues(t,a,c){const i=[];t.eligibility.nonprofit_status_required&&!a.hasNonprofitStatus&&i.push("Requires nonprofit status or fiscal sponsorship"),t.eligibility.matching_funds_required&&a.stage==="Emerging"&&i.push("Requires matching funds which may be challenging for emerging artists"),t.success_rate&&t.success_rate<.1&&i.push("Highly competitive - low success rate");const r=new Date(t.timeline.application_deadline),l=new Date;return Math.ceil((r.getTime()-l.getTime())/(1e3*60*60*24))<14&&i.push("Very tight deadline - may not allow for quality application"),t.requirements.application_materials.length>8&&i.push("Complex application with many required materials"),t.award_amount.min>5e4&&a.stage==="Emerging"&&i.push("Large award amount may require significant experience/track record"),i}static calculateGenreOverlap(t,a){return a.filter(i=>t.some(r=>i.toLowerCase().includes(r.toLowerCase())||r.toLowerCase().includes(i.toLowerCase()))).length/Math.max(a.length,1)}static calculateStageMatch(t,a){return t.includes("any")||t.includes(a==null?void 0:a.toLowerCase())?1:0}static calculateProjectTypeMatch(t,a){return!t.eligibility.project_type||!a.project?.5:({EP:["recording","album","music"],Album:["recording","album","music"],Singles:["recording","single","music"]}[a.project.projectType]||[]).some(l=>t.eligibility.project_type.includes(l))?1:.3}static calculateAmountAppropriateScore(t,a,c){const i=a.stage,r=t.award_amount.min,l=t.award_amount.max,o={Emerging:{min:500,max:15e3},Developing:{min:2e3,max:35e3},Established:{min:5e3,max:75e3},Breakout:{min:1e4,max:15e4}},m=o[i]||o.Developing;return l>=m.min&&r<=m.max?1:r>m.max?.3:.6}static calculateApplicationFeasibility(t,a,c){let i=1;const r=t.requirements.application_materials.length;return r>10&&(i-=.3),r>15&&(i-=.3),a.stage==="Emerging"&&r>8&&(i-=.2),t.requirements.references_required&&t.requirements.references_required>3&&(i-=.1),Math.max(0,i)}static calculateTimelineCompatibility(t){const a=new Date(t.timeline.application_deadline),c=new Date,i=Math.ceil((a.getTime()-c.getTime())/(1e3*60*60*24));return i<0?0:i<7?.2:i<14?.5:i<30?.8:1}static calculateSuccessProbability(t,a,c){var l,o;let i=t.success_rate||.15;const r=a.stage;return(l=t.eligibility.career_stage)!=null&&l.includes("emerging")&&r==="Emerging"&&(i+=.1),t.award_amount.min>25e3&&["Established","Breakout"].includes(r)&&(i+=.05),((o=t.eligibility.geographic_restrictions)==null?void 0:o.length)===1&&(i+=.05),Math.min(1,i)}}function E(g,t){return g.filter(a=>{if(t.grant_types&&!t.grant_types.includes(a.grant_type)||t.categories&&!t.categories.includes(a.category)||t.funding_sources&&!t.funding_sources.includes(a.funding_source))return!1;if(t.award_amount_range){const{min:c,max:i}=t.award_amount_range;if(a.award_amount.max<c||a.award_amount.min>i)return!1}if(t.deadline_range){const c=new Date(a.timeline.application_deadline),i=new Date(t.deadline_range.start),r=new Date(t.deadline_range.end);if(c<i||c>r)return!1}if(t.genres&&a.eligibility.genres&&!t.genres.some(i=>a.eligibility.genres.some(r=>i.toLowerCase().includes(r.toLowerCase())||r.toLowerCase().includes(i.toLowerCase()))))return!1;if(t.keywords){const c=`${a.title} ${a.description} ${a.funder_name}`.toLowerCase();if(!t.keywords.toLowerCase().split(" ").some(l=>c.includes(l)))return!1}return!0})}function $(g,t,a="desc"){return[...g].sort((c,i)=>{let r=0;switch(t){case"deadline":r=new Date(c.timeline.application_deadline).getTime()-new Date(i.timeline.application_deadline).getTime();break;case"amount":r=c.award_amount.max-i.award_amount.max;break;case"success_rate":r=(c.success_rate||0)-(i.success_rate||0);break;default:r=0}return a==="asc"?r:-r})}const I=({profile:g,assessment:t,onSaveGrant:a,onStartApplication:c,savedGrants:i=[],applications:r=[]})=>{const[l,o]=v.useState({}),[m,x]=v.useState("compatibility"),[u,h]=v.useState("recommended"),[w,N]=v.useState(null),y=v.useMemo(()=>t?S.filterByEligibility(M,g,t):M,[g,t]),f=v.useMemo(()=>t?S.analyzeArtistProfile(g,t,y):[],[g,t,y]),C=v.useMemo(()=>{let s=[];switch(u){case"recommended":s=f.slice(0,20).map(n=>n.grant);break;case"all":s=E(y,l);break;case"saved":s=M.filter(n=>i.includes(n.id));break;case"deadlines":s=A(60);break;default:s=y}return $(s,m)},[u,f,y,l,i,m]),T=s=>f.find(n=>n.grant.id===s),L=s=>{const n=r.find(d=>d.grant_id===s);return n==null?void 0:n.status},D=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(s),q=s=>{const n=new Date(s),d=new Date,p=Math.ceil((n.getTime()-d.getTime())/(1e3*60*60*24));return p<0?"Past deadline":p===0?"Due today":p===1?"Due tomorrow":p<=7?`Due in ${p} days`:p<=30?`Due in ${Math.ceil(p/7)} weeks`:n.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},k=s=>{const n=new Date(s),d=new Date,p=Math.ceil((n.getTime()-d.getTime())/(1e3*60*60*24));return p<0||p<=7?"text-red-400":p<=14?"text-yellow-400":p<=30?"text-orange-400":"text-surface-300"};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-surface-50",children:"Grant Opportunities"}),e.jsx("p",{className:"text-sm text-surface-400",children:u==="recommended"&&t?`${f.length} grants matched to your profile`:`${C.length} grants available`})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["recommended","all","deadlines","saved"].map(s=>e.jsxs("button",{onClick:()=>h(s),className:`px-3 py-2 rounded-lg text-sm transition-colors ${u===s?"bg-primary-600 text-primary-50":"bg-surface-700 text-surface-300 hover:bg-surface-600"}`,children:[s==="recommended"&&"ðŸŽ¯ Recommended",s==="all"&&"ðŸ“‹ All Grants",s==="deadlines"&&"â° Upcoming Deadlines",s==="saved"&&`ðŸ’¾ Saved (${i.length})`]},s))})]}),u==="all"&&e.jsx("div",{className:"bg-surface-800/50 rounded-xl p-4 border border-surface-700",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-3 lg:grid-cols-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-surface-300",children:"Award Amount"}),e.jsxs("select",{className:"w-full bg-surface-700 rounded-lg px-3 py-2 text-surface-100",onChange:s=>{const n=s.target.value;if(n==="all")o(d=>({...d,award_amount_range:void 0}));else{const[d,p]=n.split("-").map(Number);o(_=>({..._,award_amount_range:{min:d,max:p}}))}},children:[e.jsx("option",{value:"all",children:"All amounts"}),e.jsx("option",{value:"0-5000",children:"Under $5K"}),e.jsx("option",{value:"5000-15000",children:"$5K - $15K"}),e.jsx("option",{value:"15000-50000",children:"$15K - $50K"}),e.jsx("option",{value:"50000-999999",children:"$50K+"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-surface-300",children:"Category"}),e.jsxs("select",{className:"w-full bg-surface-700 rounded-lg px-3 py-2 text-surface-100",onChange:s=>{const n=s.target.value;o(d=>({...d,categories:n==="all"?void 0:[n]}))},children:[e.jsx("option",{value:"all",children:"All categories"}),e.jsx("option",{value:"recording",children:"Recording"}),e.jsx("option",{value:"artist_development",children:"Artist Development"}),e.jsx("option",{value:"education",children:"Education"}),e.jsx("option",{value:"community_outreach",children:"Community"}),e.jsx("option",{value:"emergency",children:"Emergency"}),e.jsx("option",{value:"touring",children:"Touring"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-surface-300",children:"Funding Source"}),e.jsxs("select",{className:"w-full bg-surface-700 rounded-lg px-3 py-2 text-surface-100",onChange:s=>{const n=s.target.value;o(d=>({...d,funding_sources:n==="all"?void 0:[n]}))},children:[e.jsx("option",{value:"all",children:"All sources"}),e.jsx("option",{value:"federal",children:"Federal"}),e.jsx("option",{value:"state",children:"State"}),e.jsx("option",{value:"private_foundation",children:"Private Foundation"}),e.jsx("option",{value:"nonprofit",children:"Nonprofit"}),e.jsx("option",{value:"corporate",children:"Corporate"}),e.jsx("option",{value:"local",children:"Local"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-surface-300",children:"Sort By"}),e.jsxs("select",{className:"w-full bg-surface-700 rounded-lg px-3 py-2 text-surface-100",value:m,onChange:s=>x(s.target.value),children:[e.jsx("option",{value:"compatibility",children:"Best Match"}),e.jsx("option",{value:"deadline",children:"Deadline"}),e.jsx("option",{value:"amount",children:"Award Amount"}),e.jsx("option",{value:"success_rate",children:"Success Rate"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-surface-300",children:"Â "}),e.jsx("button",{onClick:()=>o({}),className:"w-full bg-surface-600 hover:bg-surface-500 rounded-lg px-3 py-2 text-surface-100 transition-colors",children:"Clear Filters"})]})]})}),e.jsx("div",{className:"space-y-4",children:C.length===0?e.jsxs("div",{className:"text-center py-12 bg-surface-800/30 rounded-xl border border-surface-700",children:[e.jsx("div",{className:"text-surface-400 mb-2",children:"No grants found"}),e.jsx("div",{className:"text-sm text-surface-500",children:"Try adjusting your filters or view mode"})]}):C.map(s=>{const n=T(s.id),d=L(s.id),p=w===s.id,_=i.includes(s.id);return e.jsxs("div",{className:"bg-surface-800/50 rounded-xl border border-surface-700 overflow-hidden",children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-surface-50 truncate",children:s.title}),n&&e.jsxs("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${n.compatibility_score>=80?"bg-green-500/20 text-green-400":n.compatibility_score>=60?"bg-yellow-500/20 text-yellow-400":"bg-blue-500/20 text-blue-400"}`,children:[n.compatibility_score,"% match"]}),d&&e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${d==="submitted"?"bg-blue-500/20 text-blue-400":d==="in_progress"?"bg-yellow-500/20 text-yellow-400":d==="approved"?"bg-green-500/20 text-green-400":d==="denied"?"bg-red-500/20 text-red-400":"bg-surface-600/50 text-surface-400"}`,children:d.replace("_"," ")})]}),e.jsx("p",{className:"text-surface-400 text-sm mb-3 line-clamp-2",children:s.summary}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-surface-500",children:"Award Amount"}),e.jsxs("div",{className:"text-surface-200 font-medium",children:[D(s.award_amount.min)," - ",D(s.award_amount.max)]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-surface-500",children:"Deadline"}),e.jsx("div",{className:`font-medium ${k(s.timeline.application_deadline)}`,children:q(s.timeline.application_deadline)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-surface-500",children:"Funder"}),e.jsx("div",{className:"text-surface-200 truncate",children:s.funder_name})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-surface-500",children:"Success Rate"}),e.jsx("div",{className:"text-surface-200",children:s.success_rate?`${Math.round(s.success_rate*100)}%`:"N/A"})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("button",{onClick:()=>N(p?null:s.id),className:"px-3 py-2 bg-primary-600 hover:bg-primary-700 text-primary-50 rounded-lg text-sm transition-colors",children:p?"Less Info":"View Details"}),a&&e.jsx("button",{onClick:()=>a(s),className:`px-3 py-2 rounded-lg text-sm transition-colors ${_?"bg-green-600/20 text-green-400 border border-green-600/30":"bg-surface-700 hover:bg-surface-600 text-surface-300"}`,children:_?"âœ“ Saved":"Save"}),c&&!d&&e.jsx("button",{onClick:()=>c(s),className:"px-3 py-2 bg-accent-600 hover:bg-accent-700 text-accent-50 rounded-lg text-sm transition-colors",children:"Apply"})]})]}),n&&n.matching_factors.length>0&&e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:n.matching_factors.slice(0,3).map((b,j)=>e.jsxs("span",{className:"px-2 py-1 bg-primary-500/20 text-primary-300 rounded text-xs",children:["âœ“ ",b]},j))})]}),p&&e.jsx("div",{className:"border-t border-surface-700 p-6 bg-surface-900/30",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-surface-200 mb-2",children:"Description"}),e.jsx("p",{className:"text-surface-400 text-sm leading-relaxed",children:s.description}),e.jsx("h4",{className:"text-sm font-semibold text-surface-200 mb-2 mt-4",children:"Eligibility"}),e.jsxs("div",{className:"space-y-1 text-sm text-surface-400",children:[s.eligibility.career_stage&&e.jsxs("div",{children:["Career Stage: ",s.eligibility.career_stage.join(", ")]}),s.eligibility.genres&&e.jsxs("div",{children:["Genres: ",s.eligibility.genres.join(", ")]}),s.eligibility.geographic_restrictions&&e.jsxs("div",{children:["Location: ",s.eligibility.geographic_restrictions.join(", ")]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-surface-200 mb-2",children:"Required Materials"}),e.jsxs("ul",{className:"text-sm text-surface-400 space-y-1 mb-4",children:[s.requirements.application_materials.slice(0,5).map((b,j)=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-1 bg-surface-500 rounded-full"}),b]},j)),s.requirements.application_materials.length>5&&e.jsxs("li",{className:"text-surface-500 text-xs",children:["+",s.requirements.application_materials.length-5," more materials"]})]}),n&&n.recommendations.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"text-sm font-semibold text-surface-200 mb-2",children:"Recommendations"}),e.jsx("ul",{className:"text-sm text-green-400 space-y-1",children:n.recommendations.slice(0,3).map((b,j)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-1 h-1 bg-green-400 rounded-full mt-2"}),b]},j))})]}),n&&n.potential_issues.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"text-sm font-semibold text-surface-200 mb-2 mt-4",children:"Consider"}),e.jsx("ul",{className:"text-sm text-yellow-400 space-y-1",children:n.potential_issues.map((b,j)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-1 h-1 bg-yellow-400 rounded-full mt-2"}),b]},j))})]}),s.funder_website&&e.jsx("div",{className:"mt-4",children:e.jsxs("a",{href:s.funder_website,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-primary-400 hover:text-primary-300 text-sm transition-colors",children:["Visit Funder Website",e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z",clipRule:"evenodd"})})]})})]})]})})]},s.id)})}),u==="recommended"&&f.length>0&&e.jsxs("div",{className:"bg-primary-900/20 border border-primary-700/30 rounded-xl p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-primary-200 mb-3",children:"Grant Opportunities Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-primary-400",children:"High Match (80%+)"}),e.jsxs("div",{className:"text-primary-100 font-medium",children:[f.filter(s=>s.compatibility_score>=80).length," grants"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-primary-400",children:"Total Funding"}),e.jsx("div",{className:"text-primary-100 font-medium",children:D(f.slice(0,10).reduce((s,n)=>s+n.grant.award_amount.max,0))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-primary-400",children:"Upcoming Deadlines"}),e.jsxs("div",{className:"text-primary-100 font-medium",children:[f.filter(s=>{const n=Math.ceil((new Date(s.grant.timeline.application_deadline).getTime()-new Date().getTime())/864e5);return n<=30&&n>0}).length," in 30 days"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-primary-400",children:"Emergency Grants"}),e.jsxs("div",{className:"text-primary-100 font-medium",children:[f.filter(s=>s.grant.category==="emergency").length," available"]})]})]})]})]})};export{I as default};
