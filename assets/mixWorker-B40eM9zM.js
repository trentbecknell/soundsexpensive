(function(){"use strict";const f={"Atlanta, GA":{name:"Atlanta",state_province:"Georgia",population_millions:6.1,music_scene_strength:.95,music_industry_presence:"major",genre_preferences:{pop:.75,rnb:.95,hip_hop:.98,electronic:.65,alternative:.55,latin:.7,country:.6,rock:.5},sonic_profile:{preferred_tempo_range:[70,140],preferred_energy:[.6,.95],bass_culture:"heavy",production_preference:"polished"},key_venues:["The Tabernacle","Center Stage","Terminal West","Mercedes-Benz Stadium"],influential_radio_stations:["Hot 107.9","V-103","Streetz 94.5"],local_tastemakers:["DJ Drama","DJ Holiday","DJ Scream"],music_festivals:["ONE Musicfest","Shaky Knees","Music Midtown"],scene_description:"Hip-hop and R&B capital. Home to trap music. Massive influence on modern hip-hop sound.",target_demographics:["18-34 hip-hop heads","Urban music fans","Club scene"],best_strategies:["Connect with Quality Control, 1017, or other ATL labels","Get spins on Hot 107.9 or Streetz 94.5","Perform at underground venues in Little Five Points","Collaborate with Atlanta producers or artists"]},"Los Angeles, CA":{name:"Los Angeles",state_province:"California",population_millions:13.2,music_scene_strength:.98,music_industry_presence:"major",genre_preferences:{pop:.95,rnb:.85,hip_hop:.9,electronic:.85,alternative:.85,latin:.95,country:.4,rock:.75},sonic_profile:{preferred_tempo_range:[80,135],preferred_energy:[.5,.9],bass_culture:"moderate",production_preference:"polished"},key_venues:["The Troubadour","El Rey Theatre","The Roxy","The Greek Theatre","Crypto.com Arena"],influential_radio_stations:["Power 106","KROQ","KCRW","Real 92.3"],local_tastemakers:["DJ Mustard","YG","Kendrick Lamar camp"],music_festivals:["Rolling Loud LA","Camp Flog Gnaw","FYF Fest"],scene_description:"Entertainment capital. Diverse scene from West Coast hip-hop to indie. Major industry hub.",target_demographics:["Entertainment industry","Beach/surf culture","Latin community","Indie scene"],best_strategies:["Showcase at industry venues like The Troubadour","Connect with A&Rs and managers in WeHo/Beverly Hills","Get featured on KCRW or KROQ for indie/alternative","Target Latin market (huge demographic)"]},"New York City, NY":{name:"New York City",state_province:"New York",population_millions:19.8,music_scene_strength:.98,music_industry_presence:"major",genre_preferences:{pop:.9,rnb:.9,hip_hop:.95,electronic:.9,alternative:.9,latin:.95,country:.3,rock:.85},sonic_profile:{preferred_tempo_range:[85,140],preferred_energy:[.6,.95],bass_culture:"heavy",production_preference:"experimental"},key_venues:["Bowery Ballroom","Brooklyn Steel","Webster Hall","SOB's","Madison Square Garden"],influential_radio_stations:["Hot 97","Power 105.1","Z100","The Beat"],local_tastemakers:["Funkmaster Flex","Ebro","Angie Martinez"],music_festivals:["Governors Ball","Panorama","Rolling Loud NYC"],scene_description:"Birthplace of hip-hop. Diverse boroughs with distinct scenes. Highly competitive but influential.",target_demographics:["Hip-hop purists","Brooklyn indie scene","Bronx/Harlem culture","Manhattan nightlife"],best_strategies:["Build buzz in specific boroughs (Brooklyn indie, Bronx hip-hop)","Get Hot 97 or Power 105 support","Perform at Brooklyn venues for indie cred","Connect with A&Rs at major labels (most are NYC-based)"]},"Miami, FL":{name:"Miami",state_province:"Florida",population_millions:6.2,music_scene_strength:.85,music_industry_presence:"strong",genre_preferences:{pop:.85,rnb:.8,hip_hop:.9,electronic:.95,alternative:.6,latin:.98,country:.3,rock:.55},sonic_profile:{preferred_tempo_range:[95,145],preferred_energy:[.7,.98],bass_culture:"heavy",production_preference:"polished"},key_venues:["LIV","E11EVEN","Story","Ball & Chain","The Fillmore Miami Beach"],influential_radio_stations:["99 Jamz","Power 96","Mega 94.9"],local_tastemakers:["DJ Khaled","Pitbull camp","Rick Ross"],music_festivals:["Ultra Music Festival","Rolling Loud Miami","III Points"],scene_description:"Latin music hub and electronic music capital (Ultra). Club culture dominates. Caribbean influence.",target_demographics:["Latin community","EDM fans","Nightclub scene","Caribbean diaspora"],best_strategies:["Target Latin market - Spanish language/features highly effective","Focus on club-ready production","Connect with reggaeton and Latin trap producers","Ultra Music Festival showcase opportunities"]},"Nashville, TN":{name:"Nashville",state_province:"Tennessee",population_millions:1.9,music_scene_strength:.92,music_industry_presence:"major",genre_preferences:{pop:.8,rnb:.7,hip_hop:.7,electronic:.6,alternative:.75,latin:.5,country:.98,rock:.8},sonic_profile:{preferred_tempo_range:[80,120],preferred_energy:[.5,.8],bass_culture:"moderate",production_preference:"balanced"},key_venues:["The Bluebird Cafe","Ryman Auditorium","Exit/In","The Basement","Grand Ole Opry"],influential_radio_stations:["WSM","Nash FM","Lightning 100"],local_tastemakers:["Country music publishers","Songwriter community"],music_festivals:["CMA Fest","Bonnaroo","Americanafest"],scene_description:"Country music capital and major songwriting hub. Growing pop and rock scenes.",target_demographics:["Country fans","Songwriters","Americana enthusiasts","Live music tourists"],best_strategies:["Showcase songwriting at The Bluebird Cafe","Connect with Nashville publishers and co-writers","Consider country crossover if pop/rock artist","Play on Broadway for tourist exposure"]},"Chicago, IL":{name:"Chicago",state_province:"Illinois",population_millions:9.5,music_scene_strength:.88,music_industry_presence:"strong",genre_preferences:{pop:.8,rnb:.85,hip_hop:.92,electronic:.85,alternative:.8,latin:.75,country:.4,rock:.75},sonic_profile:{preferred_tempo_range:[75,135],preferred_energy:[.6,.9],bass_culture:"heavy",production_preference:"raw"},key_venues:["Metro","Empty Bottle","House of Blues Chicago","United Center"],influential_radio_stations:["Power 92","WGCI","Q87.7"],local_tastemakers:["Chance The Rapper camp","Vic Mensa","G Herbo"],music_festivals:["Lollapalooza","Pitchfork Music Festival","North Coast"],scene_description:"Drill music birthplace. Strong house music history. Gritty, authentic hip-hop scene.",target_demographics:["Drill/hip-hop fans","House music heads","South Side culture","College students"],best_strategies:["Connect with drill scene if hip-hop artist","Target college demographic (large student population)","House music crossover opportunities","Authentic, raw production valued over polish"]},"Houston, TX":{name:"Houston",state_province:"Texas",population_millions:7.1,music_scene_strength:.85,music_industry_presence:"strong",genre_preferences:{pop:.75,rnb:.85,hip_hop:.95,electronic:.7,alternative:.65,latin:.9,country:.7,rock:.6},sonic_profile:{preferred_tempo_range:[65,125],preferred_energy:[.5,.85],bass_culture:"heavy",production_preference:"balanced"},key_venues:["House of Blues Houston","White Oak Music Hall","NRG Stadium"],influential_radio_stations:["97.9 The Box","Mix 96.5","104.9 The Beat"],local_tastemakers:["DJ Screw legacy","Travis Scott camp","Bun B"],music_festivals:["Day For Night","Free Press Summer Fest","Astroworld Festival"],scene_description:"Chopped and screwed originators. Slow, heavy bass culture. Strong Latin influence.",target_demographics:["Hip-hop fans","Car culture enthusiasts","Latin community","Southern rap heads"],best_strategies:["Embrace slow, heavy bass sound","Connect with Houston hip-hop legacy (Screw, UGK influence)","Target Latin demographic","Car audio culture - bass-heavy mixes essential"]},"Seattle, WA":{name:"Seattle",state_province:"Washington",population_millions:4,music_scene_strength:.82,music_industry_presence:"emerging",genre_preferences:{pop:.75,rnb:.7,hip_hop:.75,electronic:.85,alternative:.95,latin:.6,country:.5,rock:.9},sonic_profile:{preferred_tempo_range:[80,125],preferred_energy:[.5,.8],bass_culture:"moderate",production_preference:"raw"},key_venues:["The Crocodile","Neumos","The Showbox","Paramount Theatre"],influential_radio_stations:["KEXP","C89.5","107.7 The End"],local_tastemakers:["KEXP DJs","Sub Pop Records"],music_festivals:["Bumbershoot","Capitol Hill Block Party","Sasquatch!"],scene_description:"Grunge birthplace. Strong indie/alternative scene. Values authenticity over polish.",target_demographics:["Alternative/indie fans","Tech workers","Coffee shop culture","Grunge nostalgia"],best_strategies:["Get airplay on KEXP (highly influential)","Connect with Sub Pop or other Seattle indie labels","Authentic, raw sound preferred","Capitol Hill neighborhood shows build credibility"]},"Phoenix, AZ":{name:"Phoenix",state_province:"Arizona",population_millions:4.9,music_scene_strength:.65,music_industry_presence:"developing",genre_preferences:{pop:.8,rnb:.75,hip_hop:.85,electronic:.8,alternative:.75,latin:.9,country:.75,rock:.8},sonic_profile:{preferred_tempo_range:[85,130],preferred_energy:[.6,.9],bass_culture:"moderate",production_preference:"balanced"},key_venues:["Crescent Ballroom","The Van Buren","Talking Stick Resort Arena"],influential_radio_stations:["Power 98.3","Alt AZ 93.3","La Buena"],local_tastemakers:["Dbacks/Suns halftime shows","Arizona hip-hop scene"],music_festivals:["McDowell Mountain Music Festival","M3F","Phoenix Lights"],scene_description:"Growing market. Strong Latin influence. Desert aesthetic in alternative/electronic scenes.",target_demographics:["Latin community","College students (ASU)","Transplants from CA/Midwest"],best_strategies:["Target large Latin demographic","ASU campus shows (huge college population)","Growing EDM scene (Phoenix Lights fest)","Desert vibes resonate in branding"]},"Portland, OR":{name:"Portland",state_province:"Oregon",population_millions:2.5,music_scene_strength:.78,music_industry_presence:"emerging",genre_preferences:{pop:.7,rnb:.65,hip_hop:.7,electronic:.85,alternative:.95,latin:.55,country:.5,rock:.9},sonic_profile:{preferred_tempo_range:[80,120],preferred_energy:[.4,.75],bass_culture:"light",production_preference:"experimental"},key_venues:["Crystal Ballroom","Doug Fir Lounge","Mississippi Studios","Wonder Ballroom"],influential_radio_stations:["KEXP Seattle reach","94/7 Alternative Portland","XRAY.FM"],local_tastemakers:["Portland indie scene","DIY venue operators"],music_festivals:["Project PABST","MusicfestNW","Pickathon"],scene_description:"Quirky indie scene. Values experimental and DIY. Anti-commercial aesthetic.",target_demographics:["Indie purists","DIY scene","Hipster culture","Environmentalists"],best_strategies:["Embrace DIY and anti-commercial aesthetic","House shows and small venues build credibility","Experimental production valued","Sustainability and social consciousness matter"]}};function b(e,t,r){const n=t.toLowerCase().replace(/\s+/g,"_").replace("&",""),i=(r.genre_preferences[n]||.5)*100,s=e.tempo_bpm>=r.sonic_profile.preferred_tempo_range[0]&&e.tempo_bpm<=r.sonic_profile.preferred_tempo_range[1]?100:70,l=e.energy>=r.sonic_profile.preferred_energy[0]&&e.energy<=r.sonic_profile.preferred_energy[1]?100:70,o=(s+l)/2,d=r.music_scene_strength*20,a=Math.round(i*.5+o*.3+d*1),p=[],g=[];return i>85&&p.push(`Strong ${t} scene`),r.music_industry_presence==="major"&&p.push("Major industry presence"),r.music_scene_strength>.85&&p.push("Vibrant music community"),p.push(r.scene_description),g.push(...r.best_strategies.slice(0,3)),{region:`${r.name}, ${r.state_province}`,match_score:Math.min(a,100),strengths:p,key_venues:r.key_venues.slice(0,4),recommended_actions:g}}function v(e,t){const r=t||"Pop",n=Object.values(f).map(i=>b(e,r,i));return n.sort((i,s)=>s.match_score-i.match_score),{country:"United States",top_subregions:n.slice(0,5),market_overview:`Based on your ${r} track's characteristics, here are the best US cities to target. Consider focusing marketing efforts on these markets first.`}}const h={"North America":{region:"North America",countries:["United States","Canada"],key_cities:["New York","Los Angeles","Toronto","Atlanta","Nashville","Miami"],market_size_rank:1,streaming_penetration:.85,average_revenue_per_user:12.5,genre_preferences:{pop:.9,rnb:.85,hip_hop:.95,electronic:.7,alternative:.75,latin:.75,afrobeats:.6,k_pop:.6,rock:.7,country:.85},sonic_profile:{preferred_tempo_range:[80,140],preferred_energy:[.5,.9],preferred_valence:[.4,.8],bass_preference:"heavy",production_style:"polished"},dominant_platforms:["Spotify","Apple Music","YouTube Music","Amazon Music"],language_openness:.6,trend_adoption_speed:"early",local_artist_preference:.7,best_release_days:["Friday","Thursday"],playlist_culture:"strong",market_insights:["Highly competitive but largest market opportunity","Strong playlist culture - editorial playlist placement crucial","Hip-hop and R&B dominate streaming charts","TikTok integration essential for discovery","Regional differences: South prefers trap/R&B, coasts more diverse"]},"UK & Ireland":{region:"UK & Ireland",countries:["United Kingdom","Ireland"],key_cities:["London","Manchester","Birmingham","Dublin","Glasgow"],market_size_rank:3,streaming_penetration:.88,average_revenue_per_user:11.2,genre_preferences:{pop:.9,rnb:.8,hip_hop:.85,electronic:.9,alternative:.85,latin:.5,afrobeats:.85,k_pop:.55,rock:.75,country:.3},sonic_profile:{preferred_tempo_range:[90,140],preferred_energy:[.5,.9],preferred_valence:[.3,.7],bass_preference:"heavy",production_style:"balanced"},dominant_platforms:["Spotify","Apple Music","YouTube Music","Deezer"],language_openness:.8,trend_adoption_speed:"early",local_artist_preference:.65,best_release_days:["Friday"],playlist_culture:"strong",market_insights:["Strong culture of breaking new artists","BBC Radio 1 and Radio 6 still influential for discovery","Grime, UK drill, and Afrobeats have strong presence","Festival culture impacts summer releases","London-centric but regional scenes emerging (Manchester, Birmingham)"]},"Latin America":{region:"Latin America",countries:["Mexico","Brazil","Colombia","Argentina","Chile"],key_cities:["Mexico City","SÃ£o Paulo","Buenos Aires","BogotÃ¡","Santiago"],market_size_rank:4,streaming_penetration:.75,average_revenue_per_user:4.2,genre_preferences:{pop:.85,rnb:.65,hip_hop:.75,electronic:.8,alternative:.7,latin:.98,afrobeats:.5,k_pop:.6,rock:.7,country:.4},sonic_profile:{preferred_tempo_range:[90,130],preferred_energy:[.6,.95],preferred_valence:[.5,.9],bass_preference:"heavy",production_style:"polished"},dominant_platforms:["Spotify","YouTube Music","Deezer","Apple Music"],language_openness:.5,trend_adoption_speed:"mid",local_artist_preference:.8,best_release_days:["Friday","Thursday"],playlist_culture:"strong",market_insights:["Fastest growing streaming market globally","Reggaeton, urbano, and regional Mexican dominate","YouTube extremely important - videos essential","Collaborations with local artists highly effective","WhatsApp sharing culture impacts virality"]},"Western Europe":{region:"Western Europe",countries:["France","Germany","Netherlands","Spain","Italy"],key_cities:["Paris","Berlin","Amsterdam","Madrid","Milan"],market_size_rank:2,streaming_penetration:.8,average_revenue_per_user:9.8,genre_preferences:{pop:.85,rnb:.7,hip_hop:.8,electronic:.95,alternative:.8,latin:.65,afrobeats:.7,k_pop:.5,rock:.75,country:.2},sonic_profile:{preferred_tempo_range:[95,135],preferred_energy:[.5,.85],preferred_valence:[.4,.8],bass_preference:"moderate",production_style:"experimental"},dominant_platforms:["Spotify","Deezer","Apple Music","YouTube Music"],language_openness:.65,trend_adoption_speed:"mid",local_artist_preference:.75,best_release_days:["Friday"],playlist_culture:"strong",market_insights:["Strong electronic music culture, especially Berlin","France has quota system favoring French-language content","Festival season (summer) crucial for visibility","Each country has distinct preferences - localization important","Radio still important in France and Germany"]},"Asia-Pacific":{region:"Asia-Pacific",countries:["South Korea","Japan","Australia","Indonesia","Philippines"],key_cities:["Seoul","Tokyo","Sydney","Jakarta","Manila"],market_size_rank:5,streaming_penetration:.7,average_revenue_per_user:6.5,genre_preferences:{pop:.95,rnb:.75,hip_hop:.7,electronic:.85,alternative:.65,latin:.4,afrobeats:.45,k_pop:.98,rock:.7,country:.3},sonic_profile:{preferred_tempo_range:[90,145],preferred_energy:[.6,.95],preferred_valence:[.5,.9],bass_preference:"moderate",production_style:"polished"},dominant_platforms:["Spotify","Apple Music","YouTube Music","Melon","Line Music"],language_openness:.55,trend_adoption_speed:"early",local_artist_preference:.85,best_release_days:["Friday","Monday"],playlist_culture:"emerging",market_insights:["K-pop production standards influence preferences","Visual content (MVs) absolutely essential","Fan culture extremely engaged and organized","Japan prefers high-quality physical releases","SEA markets growing rapidly, youth-driven"]},"Africa & Middle East":{region:"Africa & Middle East",countries:["Nigeria","South Africa","Kenya","Ghana","UAE"],key_cities:["Lagos","Johannesburg","Nairobi","Accra","Dubai"],market_size_rank:7,streaming_penetration:.45,average_revenue_per_user:2.8,genre_preferences:{pop:.75,rnb:.8,hip_hop:.85,electronic:.65,alternative:.5,latin:.4,afrobeats:.98,k_pop:.4,rock:.4,country:.2},sonic_profile:{preferred_tempo_range:[95,130],preferred_energy:[.6,.95],preferred_valence:[.6,.95],bass_preference:"heavy",production_style:"raw"},dominant_platforms:["Spotify","Apple Music","YouTube Music","Boomplay","Audiomack"],language_openness:.7,trend_adoption_speed:"mid",local_artist_preference:.85,best_release_days:["Friday","Saturday"],playlist_culture:"emerging",market_insights:["Fastest growing youth population globally","Afrobeats and Amapiano dominating globally from this region","WhatsApp and social sharing extremely important","Lower streaming revenue but high engagement","Cross-pollination with diaspora communities crucial"]},Scandinavia:{region:"Scandinavia",countries:["Sweden","Norway","Denmark","Finland"],key_cities:["Stockholm","Oslo","Copenhagen","Helsinki"],market_size_rank:8,streaming_penetration:.92,average_revenue_per_user:11.8,genre_preferences:{pop:.95,rnb:.7,hip_hop:.75,electronic:.9,alternative:.85,latin:.5,afrobeats:.6,k_pop:.5,rock:.8,country:.3},sonic_profile:{preferred_tempo_range:[85,125],preferred_energy:[.5,.85],preferred_valence:[.3,.7],bass_preference:"moderate",production_style:"polished"},dominant_platforms:["Spotify","Apple Music","YouTube Music","Tidal"],language_openness:.9,trend_adoption_speed:"early",local_artist_preference:.6,best_release_days:["Friday"],playlist_culture:"strong",market_insights:["Highest streaming penetration globally","Birthplace of many pop producers and songwriters","Early adopters of new music trends","Strong indie/alternative scene","English-language music widely accepted"]}};function k(e,t){return t||(e.energy>.7&&e.tempo_bpm>120?"electronic":e.speechiness>.3?"hip_hop":e.danceability>.7&&e.energy>.6?"pop":e.energy<.6&&e.valence<.5?"alternative":e.danceability>.5&&e.energy<.7?"rnb":"pop")}function w(e,t,r){const n=t.toLowerCase().replace(/\s+/g,"_").replace("&",""),i=(r.genre_preferences[n]||.5)*100,s=e.tempo_bpm>=r.sonic_profile.preferred_tempo_range[0]&&e.tempo_bpm<=r.sonic_profile.preferred_tempo_range[1]?100:70,l=e.energy>=r.sonic_profile.preferred_energy[0]&&e.energy<=r.sonic_profile.preferred_energy[1]?100:70,o=e.valence>=r.sonic_profile.preferred_valence[0]&&e.valence<=r.sonic_profile.preferred_valence[1]?100:75,d=(s+l+o)/3,a=(10-r.market_size_rank)*10+r.streaming_penetration*30+r.average_revenue_per_user*3+(r.trend_adoption_speed==="early"?20:r.trend_adoption_speed==="mid"?10:5),p=r.language_openness*50+(r.playlist_culture==="strong"?50:r.playlist_culture==="moderate"?30:20),g=i*.4+d*.3+a*.2+p*.1,u=[],m=[],c=[];return i>80&&u.push(`Strong ${t} market presence`),r.streaming_penetration>.8&&u.push("High streaming adoption"),r.trend_adoption_speed==="early"&&u.push("Early trend adopters - good for breaking new sounds"),r.playlist_culture==="strong"&&(u.push("Strong playlist culture"),c.push("Focus on playlist pitching and curator relationships")),r.language_openness<.6&&m.push("Consider local language versions or features"),r.local_artist_preference>.75&&(m.push("High preference for local artists - collaboration recommended"),c.push("Partner with local artists or producers")),r.average_revenue_per_user<5&&m.push("Lower ARPU - focus on volume and engagement over revenue"),c.push(`Primary platforms: ${r.dominant_platforms.slice(0,2).join(", ")}`),c.push(`Best release day: ${r.best_release_days[0]}`),{region:r.region,match_score:Math.round(g),match_factors:{genre_fit:Math.round(i),sonic_fit:Math.round(d),market_opportunity:Math.round(a),cultural_fit:Math.round(p)},strengths:u,considerations:m,recommended_strategy:c}}function S(e,t){const r=k(e,t),n=Object.values(h).map(c=>w(e,r,c));n.sort((c,_)=>_.match_score-c.match_score);const i=n.slice(0,3),s=n.slice(3,6),l=n.reduce((c,_)=>c+_.match_score,0)/n.length,o=Math.round(l),d=i.flatMap(c=>h[c.region].countries.slice(0,2)),a=[];i[0].match_score>85&&a.push(`ğŸ¯ Excellent fit for ${i[0].region} - prioritize this market`),o>75?a.push("ğŸŒ High global appeal - consider simultaneous multi-region release"):o<55&&a.push("ğŸ¯ Niche appeal - focus on 1-2 key markets initially");const p=n.find(c=>["Latin America","Africa & Middle East","Asia-Pacific"].includes(c.region)&&c.match_score>70);p&&a.push(`ğŸ“ˆ Strong potential in ${p.region} - fast-growing market`);const g=i.map(c=>{const _=[];return h[c.region].playlist_culture==="strong"&&_.push("Editorial playlists","Algorithmic playlists"),e.danceability>.7&&_.push("Workout & party playlists"),e.valence<.5&&_.push("Mood & chill playlists"),e.energy>.7&&_.push("High-energy & hype playlists"),{region:c.region,playlist_types:_}}),u=[],m=i.find(c=>c.region==="North America");return m&&m.match_score>60&&u.push(v(e,r)),{primary_markets:i,secondary_markets:s,global_appeal_score:o,recommended_territories:d,market_strategy_insights:a,playlist_targeting:g,subregional_analysis:u.length>0?u:void 0}}const y={"R&B":{genre:"R&B",tempo_bpm:[70,110],danceability:[.4,.8],energy:[.3,.7],valence:[.2,.7],loudness_db:[-8,-5],dynamic_range_db:[6,10],stereo_width:[.6,.9],frequency_targets:{bass_prominence:[-3,0],mid_clarity:[-2,1],high_presence:[-4,-1]},typical_intro_seconds:[5,15],typical_duration_seconds:[180,240],reference_tracks:["SZA - Good Days","H.E.R. - Focus","Summer Walker - Playing Games"]},Pop:{genre:"Pop",tempo_bpm:[90,130],danceability:[.5,.9],energy:[.5,.9],valence:[.4,.8],loudness_db:[-6,-4],dynamic_range_db:[5,9],stereo_width:[.7,.95],frequency_targets:{bass_prominence:[-2,1],mid_clarity:[-1,2],high_presence:[-2,0]},typical_intro_seconds:[3,10],typical_duration_seconds:[165,210],reference_tracks:["Dua Lipa - Levitating","The Weeknd - Blinding Lights","Doja Cat - Kiss Me More"]},"Hip Hop":{genre:"Hip Hop",tempo_bpm:[70,140],danceability:[.6,.9],energy:[.6,.9],valence:[.3,.8],loudness_db:[-7,-4],dynamic_range_db:[4,8],stereo_width:[.5,.8],frequency_targets:{bass_prominence:[0,3],mid_clarity:[-1,1],high_presence:[-3,-1]},typical_intro_seconds:[0,8],typical_duration_seconds:[150,210],reference_tracks:["Drake - God's Plan","Kendrick Lamar - HUMBLE.","Travis Scott - SICKO MODE"]},Electronic:{genre:"Electronic",tempo_bpm:[100,150],danceability:[.7,.95],energy:[.7,.95],valence:[.4,.9],loudness_db:[-6,-3],dynamic_range_db:[4,8],stereo_width:[.8,1],frequency_targets:{bass_prominence:[-1,2],mid_clarity:[0,2],high_presence:[-1,1]},typical_intro_seconds:[8,30],typical_duration_seconds:[180,300],reference_tracks:["Disclosure - Latch","ODESZA - Say My Name","Flume - Never Be Like You"]},Alternative:{genre:"Alternative",tempo_bpm:[80,120],danceability:[.3,.7],energy:[.4,.8],valence:[.2,.7],loudness_db:[-9,-6],dynamic_range_db:[7,12],stereo_width:[.6,.9],frequency_targets:{bass_prominence:[-2,1],mid_clarity:[-1,2],high_presence:[-2,1]},typical_intro_seconds:[5,20],typical_duration_seconds:[180,270],reference_tracks:["Phoebe Bridgers - Kyoto","Tame Impala - The Less I Know The Better","Glass Animals - Heat Waves"]}};function M(e){return y[e]||y.Pop}function x(e,t){const r={loudness:A(e,t),dynamics:C(e,t),frequency_balance:T(e),stereo_imaging:F(e,t),genre_alignment:B(e,t),commercial_readiness:L(e,t)};return{overall:Math.round((r.loudness*.2+r.dynamics*.15+r.frequency_balance*.25+r.stereo_imaging*.15+r.genre_alignment*.15+r.commercial_readiness*.1)*100),breakdown:r}}function A(e,t){const[r,n]=t.loudness_db,i=(r+n)/2,s=(n-r)/2,l=Math.abs(e.loudness_db-i);return Math.max(0,1-l/(s*2))}function C(e,t){if(!e.dynamic_range_db)return .7;const[r,n]=t.dynamic_range_db,i=e.dynamic_range_db;return i>=r&&i<=n?1:i<r?Math.max(0,i/r):Math.max(0,1-(i-n)/n)}function T(e,t){if(!e.frequency_balance)return .7;const r=e.frequency_balance,n=Object.values(r),i=n.reduce((a,p)=>a+p,0)/n.length,s=n.reduce((a,p)=>a+Math.pow(p-i,2),0)/n.length,l=Math.max(0,1-s*2),o=r.bass>.5?1:r.bass*2,d=r.presence>.5?1:r.presence*2;return l*.5+o*.25+d*.25}function F(e,t){if(!e.stereo_width)return .7;const[r,n]=t.stereo_width,i=e.stereo_width;return i>=r&&i<=n?1:i<r?i/r:Math.max(0,1-(i-n)/(1-n))}function B(e,t){let r=0,n=0;const[i,s]=t.tempo_bpm;if(e.tempo_bpm>=i&&e.tempo_bpm<=s)r+=1;else{const p=Math.min(Math.abs(e.tempo_bpm-i),Math.abs(e.tempo_bpm-s));r+=Math.max(0,1-p/30)}n++;const[l,o]=t.energy;e.energy>=l&&e.energy<=o?r+=1:r+=.5,n++;const[d,a]=t.danceability;return e.danceability>=d&&e.danceability<=a?r+=1:r+=.5,n++,r/n}function L(e,t){let r=0;e.loudness_db>=-9&&e.loudness_db<=-4?r+=.3:e.loudness_db>=-12&&e.loudness_db<=-3&&(r+=.15),e.dynamic_range_db&&e.dynamic_range_db>=5&&e.dynamic_range_db<=10?r+=.3:e.dynamic_range_db&&e.dynamic_range_db>=4&&(r+=.15),e.stereo_width&&e.stereo_width>=.6&&e.stereo_width<=.9?r+=.2:e.stereo_width&&e.stereo_width>=.5&&(r+=.1);const[n,i]=t.typical_duration_seconds;return e.duration_seconds>=n&&e.duration_seconds<=i?r+=.2:e.duration_seconds>=n-30&&e.duration_seconds<=i+30&&(r+=.1),Math.min(1,r)}function E(e,t){const r=[],[n,i]=t.loudness_db;if(e.loudness_db<n-3?r.push({category:"loudness",severity:"critical",title:"Mix is Too Quiet",description:"Your mix is significantly quieter than commercial standards for this genre.",current_value:`${e.loudness_db.toFixed(1)} LUFS`,target_value:`${n} to ${i} LUFS`,recommendations:["Increase overall gain during mastering","Use a limiter to increase perceived loudness","Check if individual tracks are sitting too low in the mix","Consider parallel compression to add density"],technical_details:"LUFS (Loudness Units Full Scale) is the standard for measuring perceived loudness. Streaming platforms normalize to around -14 LUFS, but your mix should be competitive before normalization."}):e.loudness_db>i+2&&r.push({category:"loudness",severity:"warning",title:"Mix May Be Over-Compressed",description:"Your mix is very loud, which might indicate over-compression and loss of dynamics.",current_value:`${e.loudness_db.toFixed(1)} LUFS`,target_value:`${n} to ${i} LUFS`,recommendations:["Reduce limiter threshold/gain","Allow more dynamic range in the mix","Check for excessive compression on the master bus","Trust streaming platform normalization - you don't need to be the loudest"],technical_details:"Excessive loudness often comes at the cost of punch and dynamics. Modern streaming normalizes loudness anyway."}),e.dynamic_range_db&&e.dynamic_range_db<t.dynamic_range_db[0]-2&&r.push({category:"dynamics",severity:e.dynamic_range_db<4?"critical":"warning",title:"Limited Dynamic Range",description:"Your mix lacks dynamic contrast, which can make it sound flat and fatiguing.",current_value:`${e.dynamic_range_db.toFixed(1)} dB`,target_value:`${t.dynamic_range_db[0]} to ${t.dynamic_range_db[1]} dB`,recommendations:["Reduce compression on individual tracks","Use less aggressive mastering limiting","Preserve transients by using transient shapers carefully","Allow choruses to be louder than verses for impact"],technical_details:"Dynamic range is the difference between the quietest and loudest parts. Too little makes mixes sound lifeless."}),e.frequency_balance){const a=e.frequency_balance;a.bass<.5&&r.push({category:"frequency_balance",severity:"warning",title:"Weak Low End",description:"Bass frequencies are under-represented, which can make the mix sound thin.",current_value:"Below target",recommendations:["Boost bass and sub-bass frequencies (60-250 Hz)","Check if bass instruments are sitting properly in the mix","Use EQ to add weight to kick and bass","Consider layering bass elements for more presence"]}),a.bass>.9&&r.push({category:"frequency_balance",severity:"warning",title:"Excessive Low End",description:"Too much bass can make the mix sound muddy and translate poorly on small speakers.",current_value:"Above target",recommendations:["Use high-pass filters on non-bass elements","Reduce low-mid buildup (200-400 Hz)","Check bass and kick relationship - might be clashing","Reference on multiple speaker systems"]}),a.brilliance<.5&&r.push({category:"frequency_balance",severity:"suggestion",title:"Lacking High-End Sparkle",description:"High frequencies could use more presence for clarity and air.",current_value:"Below target",recommendations:["Add subtle high-shelf boost (8-12 kHz)","Use saturation or harmonic exciters for highs","Check if cymbals and vocals have enough top-end","Consider de-essing before adding highs"]})}e.stereo_width&&(e.stereo_width<.4?r.push({category:"stereo_imaging",severity:"warning",title:"Narrow Stereo Image",description:"The mix sounds too centered and lacks width.",current_value:`${(e.stereo_width*100).toFixed(0)}%`,target_value:`${(t.stereo_width[0]*100).toFixed(0)}-${(t.stereo_width[1]*100).toFixed(0)}%`,recommendations:["Pan instruments across the stereo field","Use stereo widening on appropriate tracks","Double-track guitars/vocals and pan them","Use stereo reverb and delay effects"]}):e.stereo_width>.95&&r.push({category:"stereo_imaging",severity:"suggestion",title:"Possibly Over-Widened",description:"Extreme width can cause phase issues and weak center.",current_value:`${(e.stereo_width*100).toFixed(0)}%`,target_value:`${(t.stereo_width[0]*100).toFixed(0)}-${(t.stereo_width[1]*100).toFixed(0)}%`,recommendations:["Keep bass and kick centered (mono below 150 Hz)","Check mono compatibility","Avoid excessive stereo widening plugins","Ensure lead vocals are centered"]}));const[s,l]=t.tempo_bpm;(e.tempo_bpm<s-10||e.tempo_bpm>l+10)&&r.push({category:"tempo",severity:"suggestion",title:"Tempo Outside Genre Norm",description:`This tempo is unusual for ${t.genre}. This could be intentional, but be aware it may affect playlisting.`,current_value:`${Math.round(e.tempo_bpm)} BPM`,target_value:`${s}-${l} BPM typical`,recommendations:["Consider if tempo serves the song or hinders it","If intentional, embrace it as a unique characteristic","Test with target audience for feedback","Pitch to curators who appreciate tempo experimentation"]});const[o,d]=t.typical_duration_seconds;return e.duration_seconds>d+30?r.push({category:"structure",severity:"suggestion",title:"Song is Quite Long",description:"Longer songs can have lower completion rates on streaming platforms.",current_value:`${Math.floor(e.duration_seconds/60)}:${String(Math.floor(e.duration_seconds%60)).padStart(2,"0")}`,target_value:`${Math.floor(o/60)}:${String(Math.floor(o%60)).padStart(2,"0")} - ${Math.floor(d/60)}:${String(Math.floor(d%60)).padStart(2,"0")}`,recommendations:["Consider editing for a tighter arrangement","Ensure every section serves the song","Check if intro/outro can be shortened","Long songs work if they maintain engagement throughout"]}):e.duration_seconds<o-30&&r.push({category:"structure",severity:"suggestion",title:"Song is Quite Short",description:"Very short songs might not allow enough time for listener engagement.",current_value:`${Math.floor(e.duration_seconds/60)}:${String(Math.floor(e.duration_seconds%60)).padStart(2,"0")}`,target_value:`${Math.floor(o/60)}:${String(Math.floor(o%60)).padStart(2,"0")} - ${Math.floor(d/60)}:${String(Math.floor(d%60)).padStart(2,"0")}`,recommendations:["Consider if the song feels complete","Short songs can work great if intentional","Ensure you have enough material for a satisfying listen","TikTok-friendly short format can be strategic"]}),r}function P(e,t,r){const n=[];if(r.breakdown.loudness>=.8&&n.push("âœ¨ Excellent loudness levels - competitive and professional"),r.breakdown.dynamics>=.8&&n.push("ğŸµ Great dynamic range - punchy and engaging without over-compression"),r.breakdown.frequency_balance>=.8&&n.push("ğŸšï¸ Well-balanced frequency spectrum - clear and full-bodied"),r.breakdown.stereo_imaging>=.8&&n.push("ğŸ§ Excellent stereo image - wide but focused with good center"),r.breakdown.genre_alignment>=.8&&n.push(`ğŸ¯ Strong ${t.genre} characteristics - fits the genre well`),r.breakdown.commercial_readiness>=.8&&n.push("ğŸ’ Commercial-ready production quality"),e.stereo_width&&e.stereo_width>=.75&&e.stereo_width<=.85&&n.push("ğŸŒŸ Perfect stereo width - immersive yet mono-compatible"),e.frequency_balance){const i=e.frequency_balance;i.mid>=.7&&i.presence>=.7&&n.push("ğŸ¤ Excellent midrange clarity - vocals and instruments will cut through")}return n}function D(e,t){return t.filter(r=>r.severity==="critical").length,t.filter(r=>r.severity==="warning").length,e.overall>=90?"Outstanding! This mix is release-ready and competitive with commercial standards. Minor refinements could take it to the next level, but you're in excellent shape.":e.overall>=80?"Great work! This mix is very close to professional standards. Address the key issues identified and you'll have a polished, competitive track.":e.overall>=70?"Good foundation! The core elements are there, but several improvements will help this mix compete with commercial releases. Focus on the critical and warning issues first.":e.overall>=60?"Solid start! This mix has potential but needs significant work in several areas. Prioritize the critical issues, then work through the warnings systematically.":"This mix needs substantial work to reach professional standards. Focus on fundamentals: loudness, frequency balance, and dynamics. Consider working with an experienced mix engineer or taking time to study reference tracks."}function H(e,t){const r=[],n=e.filter(s=>s.severity==="critical"),i=e.filter(s=>s.severity==="warning");return n.length>0&&r.push(`ğŸ”´ Address ${n.length} critical issue${n.length>1?"s":""} first: ${n.map(s=>s.category).join(", ")}`),i.length>0&&r.push(`âš ï¸ Fix ${i.length} warning${i.length>1?"s":""}: ${i.slice(0,3).map(s=>s.category).join(", ")}`),t.breakdown.frequency_balance<.7&&r.push("ğŸ“Š Analyze frequency spectrum with a visual EQ to identify problem areas"),t.breakdown.loudness<.7&&r.push("ğŸ”Š Study mastering techniques or consider hiring a mastering engineer"),r.push("ğŸµ A/B reference your mix against 3-5 commercial tracks in your genre"),r.push("ğŸ‘‚ Take breaks and return with fresh ears before making final decisions"),t.overall<80&&r.push("ğŸ“ Consider getting feedback from experienced mixing engineers or producers"),r}function R(e,t,r){const n=[];switch(e){case"rough-mix":n.push("ğŸšï¸ Focus on getting a balanced level for all tracks first"),n.push("ğŸ¯ Set rough panning positions to create space"),n.push("âœ‚ï¸ Use high-pass filters to clean up low-end mud"),n.push("â¸ï¸ Don't worry about perfection yet - rough balance is the goal"),t.some(i=>i.category==="loudness")&&n.push("ğŸ’¡ Loudness will be addressed in mastering - focus on balance and clarity for now");break;case"mixing":n.push("ğŸ›ï¸ Now is the time for EQ, compression, and creative effects"),n.push("ğŸ”Š Check your mix at different volumes to ensure translation"),n.push("ğŸ“ Use automation to bring out important elements"),n.push("ğŸ¨ Add depth with reverb and delay, but don't overdo it"),t.some(i=>i.category==="frequency_balance")&&n.push("ğŸšï¸ Address frequency issues now - they'll be harder to fix in mastering");break;case"mix-review":n.push("ğŸ‘‚ Listen on multiple systems: headphones, car, phone, studio monitors"),n.push("â° Take a 24-hour break and return with fresh ears"),n.push("ğŸ“Š Compare against reference tracks at matched volumes"),n.push("âœ… Make final tweaks but avoid over-analyzing"),n.push("ğŸ’¾ Save multiple versions before moving to mastering");break;case"pre-master":n.push("ğŸ¯ Ensure your mix has appropriate headroom (-6 to -3 dBFS peak)"),n.push("ğŸ” Check for any clicks, pops, or digital artifacts"),n.push("âœ‚ï¸ Verify fade-ins/fade-outs are clean"),n.push("ğŸ“ Document any specific mastering requests"),r.breakdown.dynamics<.7&&n.push("âš ï¸ Your mix may be over-compressed - consider backing off before mastering");break;case"mastered":n.push("ğŸ§ Verify the master translates well across all playback systems"),n.push("ğŸ“Š Check loudness against streaming platform targets (-14 LUFS for most)"),n.push("âœ… Ensure no clipping or distortion was introduced"),n.push("ğŸ’¾ Keep your pre-master mix file in case revisions are needed");break;case"not-sure":n.push("ğŸ“ Identify your current stage to get more specific recommendations"),n.push("ğŸ¯ If you're still adjusting levels and EQ, you're likely in mixing stage"),n.push("ğŸ”Š If you're happy with the mix and want it louder, you're ready for mastering");break}return n}function $(e,t){const r=["loudness","mastering"];switch(t){case"rough-mix":case"mixing":return e.map(n=>n.category==="loudness"&&n.severity!=="critical"?{...n,severity:"suggestion",description:n.description+" (Note: Final loudness will be addressed in mastering)"}:n);case"mix-review":case"pre-master":return e.map(n=>n.category==="loudness"?{...n,description:n.description+" (Will be addressed in mastering stage)"}:n);case"mastered":return e;case"not-sure":default:return e.map(n=>r.includes(n.category)?{...n,description:n.description+" (If not yet mastered, this will be addressed in that stage)"}:n)}}async function z(e,t,r="Pop",n="not-sure",i){const s=M(r),l=i?{...s,...i}:s,o=x(e,l),d=E(e,l),a=$(d,n),p=P(e,l,o),g=D(o,a),u=H(a,o),m=R(n,a,o),c=S(e,r);return{file_info:{name:t.name,size_bytes:t.size_bytes??0,format:t.format??"unknown"},mixing_stage:n,audio_features:e,benchmarks_used:l,score:o,issues:a,strengths:p,overall_assessment:g,next_steps:u,stage_appropriate_tips:m,similar_reference_tracks:l.reference_tracks,regional_analysis:c,analysis_timestamp:new Date().toISOString()}}self.onmessage=async e=>{const{id:t,type:r,payload:n}=e.data;try{if(r!=="compute")throw new Error("Unknown message type");const i=await z(n.features,n.fileInfo,n.targetGenre,n.mixingStage,n.customBenchmarks),s={id:t,ok:!0,result:i};self.postMessage(s)}catch(i){const s={id:t,ok:!1,error:(i==null?void 0:i.message)||"Worker compute failed"};self.postMessage(s)}}})();
