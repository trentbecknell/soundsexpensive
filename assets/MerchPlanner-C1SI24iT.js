import{j as t}from"./flags-BL-W5WOk.js";import{r as j}from"./vendor-react-BVOO17zE.js";import{i as $,M as y}from"./main-GnAiXjuh.js";import{g as G}from"./testerContact-Bnwc-oM4.js";import{l as Y,s as J,D as K,p as W}from"./pricing-RT0dD_qj.js";import"./vendor-charts-BfDgEjn4.js";function Z(m,p,d,f,n){const x=`${m.artistName||"Artist"} â€” Quote request for ${d.category} (${d.quantity})`,c=[];if(c.push(`Hi${f?` ${f}`:""},`),c.push(""),c.push(`Iâ€™m planning merch for an upcoming ${p.projectType.toLowerCase()} cycle and need a quote for:`),c.push(`- Item: ${d.category}`),c.push(`- Method: ${d.method}`),c.push(`- Quantity: ${d.quantity}`),d.colorways&&c.push(`- Colorways: ${d.colorways}`),d.sizeBreakdown&&c.push(`- Sizes: ${Object.entries(d.sizeBreakdown).map(([o,i])=>`${o} ${i}`).join(", ")}`),d.targetUnitCostUSD&&c.push(`- Target unit cost: ~$${d.targetUnitCostUSD.toFixed(2)}`),c.push(""),c.push("Please include: total cost, setup fees, lead time, and any minimum order requirements."),c.push("Artwork is ready in vector/print specs."),c.push(""),c.push("Thanks!"),c.push(`${m.artistName||"Artist"}`),n&&(n.email||n.instagram||n.website||n.phone)){if(c.push(""),c.push("â€”"),c.push("Contact me:"),(n.name||n.city)&&c.push(`- ${n.name||"Artist"}${n.city?` â€¢ ${n.city}`:""}`),n.email&&c.push(`- Email: ${n.email}`),n.instagram){const o=n.instagram.trim(),i=/^https?:\/\//i.test(o)?o:`https://instagram.com/${o.replace(/^@/,"")}`;c.push(`- Instagram: ${i}`)}if(n.website){const o=n.website.trim(),i=/^https?:\/\//i.test(o)?o:`https://${o}`;c.push(`- Website: ${i}`)}n.phone&&c.push(`- Phone: ${n.phone}`)}return{subject:x,message:c.join(`
`)}}const ee={XS:.05,S:.18,M:.3,L:.28,XL:.14,XXL:.05};function N(m){const p={XS:0,S:0,M:0,L:0,XL:0,XXL:0},d=Object.entries(ee);let f=0;for(let n=0;n<d.length;n++){const[x,c]=d[n];if(n<d.length-1){const o=Math.max(0,Math.floor(m*c));p[x]=o,f+=o}else p[x]=Math.max(0,m-f)}return p}function se(m,p){const d=["XS","S","M","L","XL","XXL"],f=d.map(g=>Math.max(0,Math.floor(m[g]??0))),n=f.reduce((g,h)=>g+h,0);if(n<=0)return N(p);const x=f.map(g=>Math.floor(g/n*p));let c=x.reduce((g,h)=>g+h,0),o=0;for(;c<p;)x[o%x.length]+=1,c+=1,o+=1;const i={XS:0,S:0,M:0,L:0,XL:0,XXL:0};return d.forEach((g,h)=>{i[g]=x[h]}),i}function le({profile:m,project:p,estimatedDraw:d,onAddToBudget:f,onToast:n}){const x=`${p.projectType}-${p.units}`,c=j.useMemo(()=>Y(m.artistName,x)||$(m,p,d).items,[m,p,d]),[o,i]=j.useState(c),g=G();j.useEffect(()=>{J(o,m.artistName,x)},[o,m.artistName,x]);const h=e=>e.toLocaleString(void 0,{style:"currency",currency:"USD",maximumFractionDigits:0}),k=(e,r)=>i(s=>s.map(a=>a.id===e?v({...a,quantity:Math.max(1,r)}):a)),P=(e,r)=>i(s=>s.map(a=>a.id===e?v({...a,targetUnitCostUSD:Math.max(0,r)}):a)),q=(e,r)=>i(s=>s.map(a=>a.id===e?{...a,colorways:Math.max(1,Math.floor(r))}:a)),O=(e,r)=>i(s=>s.map(a=>a.id===e?{...a,method:r}:a)),L=(e,r)=>i(s=>s.map(a=>a.id===e?{...a,sellPriceUSD:Math.max(0,r)}:a)),E=(e,r)=>i(s=>s.map(a=>a.id===e?{...a,preferredVendorId:r||void 0}:a)),R=(e,r,s)=>i(a=>a.map(l=>l.id===e?{...l,sizeBreakdown:{...l.sizeBreakdown||N(l.quantity),[r]:Math.max(0,Math.floor(s))}}:l)),B=e=>i(r=>r.map(s=>s.id===e?{...s,sizeBreakdown:se(s.sizeBreakdown||N(s.quantity),s.quantity)}:s)),A=e=>i(r=>r.map(s=>s.id===e?{...s,sizeBreakdown:N(s.quantity)}:s));function v(e){return e.targetUnitCostUSD?{...e,estTotalCostUSD:Math.round(e.targetUnitCostUSD*e.quantity)}:e}const X=e=>{f({description:`Merch â€” ${e.category}${e.colorways?` x${e.colorways} colorways`:""} (${e.quantity})`,totalCost:e.estTotalCostUSD||0}),n==null||n("Merch item added to budget")},z=()=>{let e=0;for(const r of o)f({description:`Merch â€” ${r.category}${r.colorways?` x${r.colorways} colorways`:""} (${r.quantity})`,totalCost:r.estTotalCostUSD||0}),e++;n==null||n(`Added ${e} merch items to budget`)},C=(e,r)=>{const{subject:s,message:a}=Z(m,p,e,r,g);navigator.clipboard.writeText(`${s}

${a}`),n==null||n("Quote request copied to clipboard")},D=o.reduce((e,r)=>e+(r.estTotalCostUSD||0),0),b=o.reduce((e,r)=>e+(r.sellPriceUSD||0)*r.quantity,0),w=Math.max(0,b-D),I=b>0?Math.round(w/b*100):0,[M,V]=j.useState(50),F={"T-Shirt":["Screen Print","DTG"],Hoodie:["Screen Print","DTG"],Hat:["Embroidery"],"Sticker Pack":["Sticker Die-Cut"],Tote:["Screen Print"],Poster:["Sublimation"],Vinyl:["Vinyl Pressing"],CD:["CD Duplication"]};function U(e,r){const s=y.filter(u=>u.categories.includes(e));if(r){const u=y.find(S=>S.id===r);return{minOrder:u==null?void 0:u.minOrder,leadDays:u==null?void 0:u.avgLeadDays}}const a=Math.min(...s.map(u=>u.minOrder||0).filter(u=>u>0)),l=Math.round(s.map(u=>u.avgLeadDays||0).filter(u=>u>0).reduce((u,S)=>u+S,0)/Math.max(1,s.map(u=>u.avgLeadDays||0).filter(u=>u>0).length));return{minOrder:Number.isFinite(a)?a:void 0,leadDays:Number.isFinite(l)&&l>0?l:void 0}}function T(e){const r=y.filter(l=>l.categories.includes(e)),s=r.some(l=>l.dropship),a=r.some(l=>l.ecoOptions);return{hasDropship:s,hasEco:a}}const Q=e=>{if(!e.length)return"";const r=Object.keys(e[0]),s=[r.join(",")];for(const a of e)s.push(r.map(l=>JSON.stringify(a[l]??"")).join(","));return s.join(`
`)},_=(e,r)=>{const s=new Blob([r],{type:"text/csv"}),a=URL.createObjectURL(s),l=document.createElement("a");l.href=a,l.download=e,l.click(),URL.revokeObjectURL(a)},H=()=>{const e=o.map(r=>({category:r.category,method:r.method,quantity:r.quantity,colorways:r.colorways||"",unitCost:r.targetUnitCostUSD||"",total:r.estTotalCostUSD||""}));_(`${(m.artistName||"artist").replaceAll(" ","-")}-merch.csv`,Q(e)),n==null||n("Merch CSV exported")};return t.jsxs("div",{children:[t.jsxs("div",{className:"mb-6 rounded-2xl border border-primary-700 bg-primary-900/20 p-6 backdrop-blur",children:[t.jsx("h2",{className:"text-xl font-semibold text-primary-100 mb-2",children:"ðŸ›ï¸ Merch Planner"}),t.jsx("p",{className:"text-surface-300 text-sm",children:"Recommended merch lineup based on your project and expected draw. Adjust quantities, copy a vendor quote request, or add items to your budget."}),t.jsxs("div",{className:"mt-3 flex items-center gap-3 text-sm text-primary-200",children:[t.jsxs("span",{children:["Estimated total cost: ",h(D)]}),t.jsx("span",{className:"text-surface-400",children:"â€¢"}),t.jsxs("span",{children:["Projected revenue: ",h(b)]}),t.jsx("span",{className:"text-surface-400",children:"â€¢"}),t.jsxs("span",{children:["Gross margin: ",h(w)," (",I,"%)"]}),t.jsx("span",{className:"text-surface-400",children:"â€¢"}),t.jsx("button",{className:"text-xs rounded border border-surface-600 text-surface-200 px-2 py-1 hover:bg-surface-700",onClick:()=>i(e=>e.map(r=>({...r,sellPriceUSD:K[r.category]||r.sellPriceUSD||0}))),children:"Suggest sell prices"}),t.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[t.jsx("label",{className:"text-surface-300",children:"Target margin %"}),t.jsx("input",{type:"number",min:0,max:90,className:"w-16 rounded bg-surface-900 px-2 py-1",value:M,onChange:e=>V(Math.max(0,Math.min(90,parseInt(e.target.value||"0"))))}),t.jsx("button",{className:"text-xs rounded border border-primary-600 text-primary-200 px-2 py-1 hover:bg-primary-700/30",onClick:()=>i(e=>e.map(r=>r.targetUnitCostUSD?{...r,sellPriceUSD:W(r.targetUnitCostUSD,M/100)}:r)),children:"Apply"})]}),t.jsx("button",{className:"text-xs rounded border border-primary-600 text-primary-200 px-2 py-1 hover:bg-primary-700/30",onClick:z,children:"Add all to budget"}),t.jsx("button",{className:"text-xs rounded border border-surface-600 text-surface-200 px-2 py-1 hover:bg-surface-700",onClick:H,children:"Export CSV"}),t.jsx("button",{className:"text-xs rounded border border-red-600 text-red-200 px-2 py-1 hover:bg-red-700/30",onClick:()=>i($(m,p,d).items),children:"Reset to recommended"})]})]}),t.jsx("div",{className:"space-y-4",children:o.map(e=>{var r;return t.jsxs("div",{className:"rounded-2xl border border-surface-700 bg-surface-800/70 p-4",children:[t.jsxs("div",{className:"flex items-start justify-between gap-3",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold text-surface-100",children:e.category}),t.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2 text-xs text-surface-300",children:[t.jsx("label",{className:"text-surface-400",children:"Method"}),t.jsx("select",{className:"rounded bg-surface-900 px-2 py-1",value:e.method,onChange:s=>O(e.id,s.target.value),children:(e.preferredVendorId?((r=y.find(s=>s.id===e.preferredVendorId))==null?void 0:r.methods)||[]:F[e.category]||[e.method]).map(s=>t.jsx("option",{value:s,children:s},s))}),["T-Shirt","Hoodie"].includes(e.category)&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"text-surface-500",children:"â€¢"}),t.jsx("label",{className:"text-surface-400",children:"Colorways"}),t.jsx("input",{type:"number",min:1,className:"w-16 rounded bg-surface-900 px-2 py-1",value:e.colorways||1,onChange:s=>q(e.id,parseInt(s.target.value||"1"))})]}),t.jsx("span",{className:"text-surface-500",children:"â€¢"}),t.jsx("label",{className:"text-surface-400",children:"Vendor"}),t.jsxs("select",{className:"rounded bg-surface-900 px-2 py-1",value:e.preferredVendorId||"",onChange:s=>E(e.id,s.target.value),children:[t.jsx("option",{value:"",children:"Any"}),y.filter(s=>s.categories.includes(e.category)).map(s=>t.jsx("option",{value:s.id,children:s.name},s.id))]})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("label",{className:"text-xs text-surface-400 block",children:"Qty"}),t.jsx("input",{type:"number",className:"w-24 rounded bg-surface-900 px-2 py-1 text-sm",value:e.quantity,onChange:s=>k(e.id,parseInt(s.target.value||"1"))})]})]}),e.sizeBreakdown&&t.jsx("div",{className:"mt-2 text-xs text-surface-300",children:t.jsxs("details",{children:[t.jsxs("summary",{className:"cursor-pointer select-none text-surface-200",children:["Sizes: ",Object.entries(e.sizeBreakdown).map(([s,a])=>`${s} ${a}`).join(", ")]}),t.jsx("div",{className:"mt-2 grid grid-cols-6 gap-2",children:Object.keys(e.sizeBreakdown).map(s=>{var a;return t.jsxs("div",{className:"flex flex-col items-start text-[11px]",children:[t.jsx("label",{className:"text-surface-400 mb-1",children:String(s)}),t.jsx("input",{type:"number",min:0,className:"w-full rounded bg-surface-900 px-2 py-1",value:((a=e.sizeBreakdown)==null?void 0:a[s])??0,onChange:l=>R(e.id,s,parseInt(l.target.value||"0"))})]},String(s))})}),t.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[t.jsxs("button",{className:"text-xs rounded border border-surface-600 text-surface-300 px-2 py-1 hover:bg-surface-700",onClick:()=>B(e.id),children:["Rebalance to ",e.quantity]}),t.jsx("button",{className:"text-xs rounded border border-surface-600 text-surface-300 px-2 py-1 hover:bg-surface-700",onClick:()=>A(e.id),children:"Reset default sizes"})]})]})}),t.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-3 text-xs text-surface-300",children:[t.jsx("label",{className:"text-surface-400",children:"Unit cost (USD)"}),t.jsx("input",{type:"number",min:0,step:"0.01",className:"w-28 rounded bg-surface-900 px-2 py-1",value:e.targetUnitCostUSD??0,onChange:s=>P(e.id,parseFloat(s.target.value||"0"))}),t.jsx("span",{className:"text-surface-500",children:"â€¢"}),t.jsxs("span",{children:["Est. total: ",e.estTotalCostUSD?h(e.estTotalCostUSD):"â€”"]}),t.jsx("span",{className:"text-surface-500",children:"â€¢"}),t.jsx("label",{className:"text-surface-400",children:"Sell price"}),t.jsx("input",{type:"number",min:0,step:"0.01",className:"w-24 rounded bg-surface-900 px-2 py-1",value:e.sellPriceUSD??0,onChange:s=>L(e.id,parseFloat(s.target.value||"0"))}),t.jsx("span",{className:"text-surface-500",children:"â€¢"}),t.jsxs("span",{children:["Revenue: ",e.sellPriceUSD?h((e.sellPriceUSD||0)*e.quantity):"â€”"]}),e.sellPriceUSD&&e.estTotalCostUSD?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"text-surface-500",children:"â€¢"}),t.jsxs("span",{children:["Margin: ",h((e.sellPriceUSD||0)*e.quantity-(e.estTotalCostUSD||0))]})]}):null]}),(()=>{const s=U(e.category,e.preferredVendorId),a=T(e.category);return s.minOrder||s.leadDays||a.hasDropship||a.hasEco?t.jsxs("div",{className:"mt-2 text-[11px] text-surface-400",children:[s.minOrder&&t.jsxs("span",{className:"mr-3",children:["Typical MOQ: ",s.minOrder]}),s.leadDays&&t.jsxs("span",{children:["Avg lead: ~",s.leadDays," days"]}),a.hasDropship&&t.jsxs("span",{className:"ml-3 inline-flex items-center gap-1 text-surface-300",children:[t.jsx("span",{className:"w-1.5 h-1.5 bg-surface-500 rounded-full"})," Dropship options"]}),a.hasEco&&t.jsxs("span",{className:"ml-2 inline-flex items-center gap-1 text-green-300",children:[t.jsx("span",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"})," Eco options"]})]}):null})(),(()=>{const s=U(e.category,e.preferredVendorId);return s.minOrder&&e.quantity<s.minOrder?t.jsx("div",{className:"mt-2 inline-flex items-center text-[11px] text-red-300 bg-red-900/20 border border-red-700/40 rounded px-2 py-1",children:"Below typical MOQ for this item"}):null})(),t.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[t.jsx("button",{className:"text-xs rounded border border-primary-600 text-primary-200 px-2 py-1 hover:bg-primary-700/30",onClick:()=>X(e),children:"Add to budget"}),t.jsx("button",{className:"text-xs rounded border border-surface-600 text-surface-300 px-2 py-1 hover:bg-surface-700",onClick:()=>C(e),children:"Copy quote (generic)"}),y.filter(s=>s.categories.includes(e.category)).slice(0,3).map(s=>t.jsxs("button",{className:"text-xs rounded border border-surface-600 text-surface-300 px-2 py-1 hover:bg-surface-700",onClick:()=>C(e,s.name),children:["Copy quote: ",s.name]},s.id)),t.jsx("button",{className:"text-xs rounded border border-surface-700 text-surface-300 px-2 py-1 hover:bg-surface-700",onClick:()=>i(s=>s.filter(a=>a.id!==e.id)),children:"Remove"})]}),t.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:y.filter(s=>s.categories.includes(e.category)).map(s=>t.jsx("a",{href:s.url,target:"_blank",rel:"noreferrer",className:"text-xs rounded border border-surface-600 px-2 py-1 text-surface-200 hover:bg-surface-700",children:s.name},s.id))})]},e.id)})})]})}export{le as default};
