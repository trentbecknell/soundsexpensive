import{r as b,j as e}from"./flags-CaM9_uOB.js";const A=({applications:u,grants:v,onUpdateApplication:o,onDeleteApplication:N,onAddReminder:w})=>{const[i,y]=b.useState("all"),[R,k]=b.useState(null),[a,c]=b.useState(null),p=t=>v.find(s=>s.id===t),f=u.filter(t=>i==="all"||t.status===i),_=t=>{switch(t){case"not_started":return"bg-surface-600 text-surface-300";case"in_progress":return"bg-yellow-500/20 text-yellow-400";case"submitted":return"bg-blue-500/20 text-blue-400";case"under_review":return"bg-purple-500/20 text-purple-400";case"approved":return"bg-green-500/20 text-green-400";case"denied":return"bg-red-500/20 text-red-400";case"funded":return"bg-green-600/20 text-green-300";default:return"bg-surface-600 text-surface-300"}},S=(t,s)=>{if(!s)return 0;const l=s.requirements.application_materials.length,n=t.completed_materials.length;return Math.round(n/l*100)},D=()=>{const t=new Date;return f.map(s=>{const l=p(s.grant_id);if(!l)return null;const n=new Date(l.timeline.application_deadline),h=Math.ceil((n.getTime()-t.getTime())/(1e3*60*60*24));return{app:s,grant:l,daysUntil:h}}).filter(s=>s!==null&&s.daysUntil<=30&&s.daysUntil>0).sort((s,l)=>s.daysUntil-l.daysUntil)},j=t=>t<=0?{text:"Past due",color:"text-red-400"}:t===1?{text:"Due tomorrow",color:"text-red-400"}:t<=3?{text:`${t} days left`,color:"text-red-400"}:t<=7?{text:`${t} days left`,color:"text-yellow-400"}:t<=14?{text:`${t} days left`,color:"text-orange-400"}:{text:`${t} days left`,color:"text-surface-300"},x=D();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-surface-50",children:"Grant Applications"}),e.jsx("p",{className:"text-sm text-surface-400",children:"Track your grant applications and deadlines"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["all","in_progress","submitted","under_review","approved","denied"].map(t=>e.jsxs("button",{onClick:()=>y(t),className:`px-3 py-2 rounded-lg text-sm transition-colors ${i===t?"bg-primary-600 text-primary-50":"bg-surface-700 text-surface-300 hover:bg-surface-600"}`,children:[t==="all"?"All":t.replace("_"," "),e.jsxs("span",{className:"ml-1 text-xs opacity-75",children:["(",t==="all"?u.length:u.filter(s=>s.status===t).length,")"]})]},t))})]}),x.length>0&&e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-xl p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-yellow-300 mb-3 flex items-center gap-2",children:"⚠️ Upcoming Deadlines"}),e.jsxs("div",{className:"space-y-2",children:[x.slice(0,3).map(({app:t,grant:s,daysUntil:l})=>{const n=j(l);return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-surface-200 text-sm font-medium",children:s.title}),e.jsx("div",{className:"text-surface-400 text-xs",children:t.project_title})]}),e.jsx("div",{className:`text-sm font-medium ${n.color}`,children:n.text})]},t.id)}),x.length>3&&e.jsxs("div",{className:"text-xs text-yellow-400 mt-2",children:["+",x.length-3," more applications with upcoming deadlines"]})]})]}),e.jsx("div",{className:"space-y-4",children:f.length===0?e.jsxs("div",{className:"text-center py-12 bg-surface-800/30 rounded-xl border border-surface-700",children:[e.jsx("div",{className:"text-surface-400 mb-2",children:"No applications found"}),e.jsx("div",{className:"text-sm text-surface-500",children:i==="all"?"Start applying to grants to track your progress here":`No applications with status: ${i.replace("_"," ")}`})]}):f.map(t=>{const s=p(t.grant_id);if(!s)return null;const l=S(t,s),n=new Date(s.timeline.application_deadline),h=Math.ceil((n.getTime()-new Date().getTime())/(1e3*60*60*24)),g=j(h);return e.jsxs("div",{className:"bg-surface-800/50 rounded-xl border border-surface-700 p-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-surface-50 truncate",children:t.project_title}),e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${_(t.status)}`,children:t.status.replace("_"," ")})]}),e.jsxs("div",{className:"text-surface-400 text-sm mb-2",children:[s.title," • ",s.funder_name]}),e.jsxs("div",{className:"text-surface-300 text-sm",children:["Requesting: $",t.requested_amount.toLocaleString()]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-surface-400 text-sm",children:"Deadline"}),e.jsx("div",{className:`font-medium ${g.color}`,children:n.toLocaleDateString()}),e.jsx("div",{className:`text-xs ${g.color}`,children:g.text})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-surface-400",children:"Application Progress"}),e.jsxs("span",{className:"text-sm text-surface-300",children:[l,"%"]})]}),e.jsx("div",{className:"w-full bg-surface-700 rounded-full h-2",children:e.jsx("div",{className:"bg-primary-500 h-2 rounded-full transition-all duration-300",style:{width:`${l}%`}})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-surface-200 mb-2",children:"Required Materials"}),e.jsx("div",{className:"space-y-2",children:s.requirements.application_materials.map((r,m)=>{const d=t.completed_materials.includes(r);return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>{const C=d?t.completed_materials.filter($=>$!==r):[...t.completed_materials,r];o(t.id,{completed_materials:C,last_updated:new Date().toISOString()})},className:`w-4 h-4 rounded border-2 flex items-center justify-center transition-colors ${d?"bg-green-500 border-green-500 text-white":"border-surface-500 hover:border-surface-400"}`,children:d&&e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsx("span",{className:`text-sm ${d?"text-surface-300 line-through":"text-surface-200"}`,children:r})]},m)})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-surface-200 mb-2",children:"Update Status"}),e.jsxs("select",{value:t.status,onChange:r=>{o(t.id,{status:r.target.value,last_updated:new Date().toISOString()})},className:"w-full bg-surface-700 rounded-lg px-3 py-2 text-surface-100 mb-3",children:[e.jsx("option",{value:"not_started",children:"Not Started"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"submitted",children:"Submitted"}),e.jsx("option",{value:"under_review",children:"Under Review"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"denied",children:"Denied"}),e.jsx("option",{value:"funded",children:"Funded"})]}),e.jsx("h4",{className:"text-sm font-semibold text-surface-200 mb-2",children:"Notes"}),e.jsx("textarea",{value:t.notes,onChange:r=>{o(t.id,{notes:r.target.value,last_updated:new Date().toISOString()})},placeholder:"Add notes about this application...",className:"w-full bg-surface-700 rounded-lg px-3 py-2 text-surface-100 text-sm h-20 resize-none"})]})]}),t.reminders.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-surface-200 mb-2",children:"Reminders"}),e.jsx("div",{className:"space-y-2",children:t.reminders.map((r,m)=>e.jsx("div",{className:`flex items-center justify-between p-2 rounded-lg ${r.completed?"bg-green-500/10 border border-green-500/20":"bg-surface-700"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>{const d=[...t.reminders];d[m]={...r,completed:!r.completed},o(t.id,{reminders:d})},className:`w-4 h-4 rounded border-2 flex items-center justify-center transition-colors ${r.completed?"bg-green-500 border-green-500 text-white":"border-surface-500 hover:border-surface-400"}`,children:r.completed&&e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsx("div",{className:`text-sm ${r.completed?"text-surface-400 line-through":"text-surface-200"}`,children:r.message}),e.jsx("div",{className:"text-xs text-surface-500",children:new Date(r.date).toLocaleDateString()})]})]})},m))})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-surface-700",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>c({applicationId:t.id,date:"",message:""}),className:"px-3 py-2 bg-primary-600 hover:bg-primary-700 text-primary-50 rounded-lg text-sm transition-colors",children:"Add Reminder"}),s.funder_website&&e.jsx("a",{href:s.funder_website,target:"_blank",rel:"noopener noreferrer",className:"px-3 py-2 bg-surface-600 hover:bg-surface-500 text-surface-200 rounded-lg text-sm transition-colors",children:"Funder Website"})]}),e.jsx("button",{onClick:()=>N(t.id),className:"px-3 py-2 bg-red-600/20 hover:bg-red-600/30 text-red-400 rounded-lg text-sm transition-colors",children:"Delete"})]})]},t.id)})}),a&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-surface-800 rounded-xl p-6 w-full max-w-md mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-surface-50 mb-4",children:"Add Reminder"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"Reminder Date"}),e.jsx("input",{type:"date",value:a.date,onChange:t=>c(s=>s?{...s,date:t.target.value}:null),className:"w-full bg-surface-700 rounded-lg px-3 py-2 text-surface-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"Message"}),e.jsx("textarea",{value:a.message,onChange:t=>c(s=>s?{...s,message:t.target.value}:null),placeholder:"What do you need to remember?",className:"w-full bg-surface-700 rounded-lg px-3 py-2 text-surface-100 h-20 resize-none"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>{a.date&&a.message&&w(a.applicationId,{date:a.date,message:a.message}),c(null)},disabled:!a.date||!a.message,className:"flex-1 px-4 py-2 bg-primary-600 hover:bg-primary-700 disabled:bg-surface-600 disabled:text-surface-400 text-primary-50 rounded-lg transition-colors",children:"Add Reminder"}),e.jsx("button",{onClick:()=>c(null),className:"px-4 py-2 bg-surface-600 hover:bg-surface-500 text-surface-200 rounded-lg transition-colors",children:"Cancel"})]})]})})]})};export{A as default};
